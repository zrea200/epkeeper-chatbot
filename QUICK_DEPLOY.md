# ğŸš€ å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## âš¡ æ¨èæ–¹æ³•ï¼ˆæŒ‰ä½¿ç”¨é¢‘ç‡æ’åºï¼‰

### æ–¹æ³•1ï¸âƒ£ï¼šDocker Compose å‘½ä»¤ï¼ˆæœ€å¸¸ç”¨ï¼Œæ¨è â­â­â­â­â­ï¼‰
```bash
# ä»£ç ä¿®æ”¹åé‡æ–°éƒ¨ç½²ï¼ˆä½¿ç”¨ç¼“å­˜ï¼Œå¿«ï¼ï¼‰
docker compose up -d --build

# ç­‰ä»·äºï¼š
# 1. é‡æ–°æ„å»ºé•œåƒï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
# 2. é‡å¯å®¹å™¨
```
**ä¼˜ç‚¹**ï¼š
- âš¡ **æœ€å¿«**ï¼ˆåˆ©ç”¨ Docker ç¼“å­˜å±‚ï¼‰
- ğŸ”§ æ ‡å‡†å‘½ä»¤ï¼Œæ‰€æœ‰ Docker ç”¨æˆ·éƒ½ç†Ÿæ‚‰
- ğŸ¯ ç®€æ´ç›´æ¥

**é€‚ç”¨åœºæ™¯**ï¼šæ—¥å¸¸å¼€å‘ï¼Œä»£ç ä¿®æ”¹åéƒ¨ç½²ï¼ˆ99%çš„æƒ…å†µï¼‰

---

### æ–¹æ³•2ï¸âƒ£ï¼šå¿«é€Ÿé‡å¯ï¼ˆä¸é‡æ–°æ„å»ºï¼‰
```bash
# åªé‡å¯å®¹å™¨ï¼Œä¸é‡æ–°æ„å»º
docker compose restart
```
**é€‚ç”¨åœºæ™¯**ï¼šä¿®æ”¹äº†è¿è¡Œæ—¶ç¯å¢ƒå˜é‡ï¼Œä¸éœ€è¦é‡æ–°æ„å»ºé•œåƒ

---

### æ–¹æ³•3ï¸âƒ£ï¼šç®€åŒ–è„šæœ¬ï¼ˆæ–°æ‰‹å‹å¥½ï¼‰
```bash
# åœæ­¢â†’æ„å»ºâ†’å¯åŠ¨â†’æ¸…ç†ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
./redeploy.sh
```
**é€‚ç”¨åœºæ™¯**ï¼šæƒ³è¦å®Œæ•´çš„åœæ­¢-æ„å»º-å¯åŠ¨æµç¨‹ï¼Œå¹¶è‡ªåŠ¨æ¸…ç†æ—§é•œåƒ

---

### æ–¹æ³•4ï¸âƒ£ï¼šå®Œå…¨æ¸…ç†é‡å»ºï¼ˆæ…¢ï¼Œä¸å¸¸ç”¨ï¼‰
```bash
# å®Œå…¨ä¸ä½¿ç”¨ç¼“å­˜é‡æ–°æ„å»ºï¼ˆ5-10åˆ†é’Ÿï¼‰
./redeploy-clean.sh
```
**é€‚ç”¨åœºæ™¯**ï¼š
- ä¾èµ–åŒ…å¤§æ›´æ–°ï¼ˆpackage.json æ”¹åŠ¨ï¼‰
- æ„å»ºå‡ºç°ç¼“å­˜é—®é¢˜
- é¦–æ¬¡éƒ¨ç½²

---

## ğŸš€ é¦–æ¬¡éƒ¨ç½²
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨è„šæœ¬
./deploy.sh --build --up

# æ–¹æ³•2ï¼šä½¿ç”¨ Docker Compose
docker compose up -d --build
```

---

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç®€åŒ–è„šæœ¬
```bash
# é‡æ–°éƒ¨ç½²ï¼ˆä¿®æ”¹ä»£ç åï¼‰
./redeploy.sh

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹çŠ¶æ€
docker compose ps
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨å®Œæ•´éƒ¨ç½²è„šæœ¬
```bash
# æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹
./deploy.sh --help

# é‡æ–°éƒ¨ç½²
./deploy.sh --down --build --up

# æŸ¥çœ‹æ—¥å¿—
./deploy.sh --logs

# æŸ¥çœ‹çŠ¶æ€
./deploy.sh --status

# é‡å¯æœåŠ¡ï¼ˆä¸é‡æ–°æ„å»ºï¼‰
./deploy.sh --restart
```

### æ–¹æ³•ä¸‰ï¼šç›´æ¥ä½¿ç”¨ Docker Compose
```bash
# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker compose down

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker compose up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# é‡å¯ï¼ˆä¸é‡æ–°æ„å»ºï¼‰
docker compose restart
```

---

## ğŸ”„ å„æ–¹æ³•å¯¹æ¯”

| æ–¹æ³• | é€Ÿåº¦ | ä½¿ç”¨ç¼“å­˜ | æ¸…ç†æ—§å®¹å™¨ | æ¸…ç†æ—§é•œåƒ | æ¨èæŒ‡æ•° |
|-----|------|---------|-----------|-----------|---------|
| `docker compose up -d --build` | âš¡âš¡âš¡âš¡âš¡ æœ€å¿« | âœ… | âœ… | âŒ | â­â­â­â­â­ |
| `docker compose restart` | âš¡âš¡âš¡âš¡âš¡ æœ€å¿« | - | - | - | â­â­â­â­ |
| `./redeploy.sh` | âš¡âš¡âš¡âš¡ å¿« | âœ… | âœ… | âœ… | â­â­â­â­ |
| `./redeploy-clean.sh` | âš¡ æ…¢ | âŒ | âœ… | âœ… | â­â­ |
| `docker rm/build/run`ï¼ˆæ—§æ–¹æ³•ï¼‰ | âš¡âš¡âš¡ ä¸€èˆ¬ | âœ… | âœ… | âŒ | â­ |

### ğŸ’¡ é€Ÿåº¦å·®å¼‚åŸå› 

**å¿«çš„åŸå› ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰ï¼š**
```bash
# Docker ä¼šå¤ç”¨è¿™äº›å±‚ï¼š
âœ“ åŸºç¡€é•œåƒå±‚ (node:20-alpine)
âœ“ pnpm å®‰è£…å±‚
âœ“ ä¾èµ–å®‰è£…å±‚ï¼ˆå¦‚æœ package.json æœªæ”¹ï¼‰
âœ“ åªé‡æ–°æ„å»ºæ”¹åŠ¨çš„ä»£ç 
```

**æ…¢çš„åŸå› ï¼ˆ--no-cacheï¼‰ï¼š**
```bash
# é‡æ–°æ„å»ºæ‰€æœ‰å±‚ï¼š
âœ— é‡æ–°ä¸‹è½½åŸºç¡€é•œåƒ
âœ— é‡æ–°å®‰è£… pnpm
âœ— é‡æ–°å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆ5-8åˆ†é’Ÿï¼‰
âœ— é‡æ–°æ„å»ºæ‰€æœ‰ä»£ç 
```

### ğŸ¯ æ¨èç”¨æ³•

**æ—¥å¸¸å¼€å‘ï¼ˆ99%çš„æƒ…å†µï¼‰ï¼š**
```bash
docker compose up -d --build  # å¿«ï¼
```

**ä¾èµ–åŒ…æ›´æ–°ï¼ˆ1%çš„æƒ…å†µï¼‰ï¼š**
```bash
./redeploy-clean.sh  # æ…¢ä½†å½»åº•
```

---

## ğŸ“Š å¸¸è§æ“ä½œ

### 1. ä¿®æ”¹é…ç½®åé‡æ–°éƒ¨ç½²
```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆå¦‚ speech-config.tsï¼‰
vim client/src/config/speech-config.ts

# ä¸€é”®é‡æ–°éƒ¨ç½²
./redeploy.sh
```

### 2. æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
docker compose logs -f
# æŒ‰ Ctrl+C é€€å‡º
```

### 3. æŸ¥çœ‹å®¹å™¨çŠ¶æ€å’Œèµ„æºå ç”¨
```bash
./deploy.sh --status
```

### 4. åªé‡å¯æœåŠ¡ï¼ˆä¸é‡æ–°æ„å»ºï¼‰
```bash
docker compose restart
# æˆ–
./deploy.sh --restart
```

### 5. å®Œå…¨æ¸…ç†å¹¶é‡æ–°éƒ¨ç½²
```bash
# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker compose down

# åˆ é™¤é•œåƒ
docker rmi epkeeper-chatbot

# é‡æ–°æ„å»ºå’Œå¯åŠ¨
./redeploy.sh
```

### 6. è¿›å…¥å®¹å™¨è°ƒè¯•
```bash
docker exec -it epkeeper-chatbot sh
```

### 7. å¤‡ä»½æ•°æ®ï¼ˆå¦‚éœ€è¦ï¼‰
```bash
docker cp epkeeper-chatbot:/app/data ./backup
```

---

## ğŸŒ è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåè®¿é—®ï¼š
- **æœ¬åœ°**ï¼šhttp://localhost:51872
- **æœåŠ¡å™¨**ï¼šhttp://your-server-ip:51872

---

## ğŸ”§ ç«¯å£é…ç½®

å½“å‰é…ç½®ç«¯å£ï¼š`51872` â†’ å®¹å™¨å†…ç«¯å£ `3000`

ä¿®æ”¹ç«¯å£ï¼šç¼–è¾‘ `docker-compose.yml` æ–‡ä»¶
```yaml
ports:
  - "ä½ çš„ç«¯å£:3000"  # ä¿®æ”¹è¿™é‡Œ
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### åŠ é€Ÿæ„å»ºï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
```bash
# ä¸ä½¿ç”¨ --no-cache
docker compose build
docker compose up -d
```

### ä»…åœ¨ä¿®æ”¹é…ç½®æ–‡ä»¶æ—¶ä½¿ç”¨å®Œå…¨é‡å»º
```bash
./redeploy.sh  # ä½¿ç”¨ --no-cache ç¡®ä¿é…ç½®æ›´æ–°
```

---

## â“ æ•…éšœæ’æŸ¥

### å®¹å™¨æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker compose logs

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps
```

### ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo lsof -i :51872

# æˆ–ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£
```

### é…ç½®æœªç”Ÿæ•ˆ
```bash
# ç¡®ä¿ä½¿ç”¨ --no-cache é‡æ–°æ„å»º
docker compose down
docker compose build --no-cache
docker compose up -d
```

### æ¸…ç†æ‰€æœ‰ Docker èµ„æº
```bash
./deploy.sh --clean

# æˆ–æ‰‹åŠ¨æ¸…ç†
docker system prune -a
```

---

## ğŸ“ æ€»ç»“ & é€ŸæŸ¥è¡¨

### ğŸ¯ æœ€å¸¸ç”¨å‘½ä»¤ï¼ˆæ—¥å¸¸å¼€å‘ï¼‰

```bash
# 1. ä¿®æ”¹ä»£ç åé‡æ–°éƒ¨ç½²ï¼ˆâ­ æœ€å¸¸ç”¨ï¼‰
docker compose up -d --build

# 2. æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker compose logs -f

# 3. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker compose ps
```

### ğŸ”§ å®Œæ•´å‘½ä»¤å¯¹ç…§è¡¨

| éœ€æ±‚ | æ¨èå‘½ä»¤ | é€Ÿåº¦ |
|-----|---------|------|
| ä¿®æ”¹ä»£ç åéƒ¨ç½² | `docker compose up -d --build` | âš¡âš¡âš¡âš¡âš¡ |
| åªé‡å¯å®¹å™¨ | `docker compose restart` | âš¡âš¡âš¡âš¡âš¡ |
| åœæ­¢æœåŠ¡ | `docker compose down` | âš¡âš¡âš¡âš¡âš¡ |
| æŸ¥çœ‹æ—¥å¿— | `docker compose logs -f` | - |
| å®Œæ•´é‡æ–°éƒ¨ç½²+æ¸…ç† | `./redeploy.sh` | âš¡âš¡âš¡âš¡ |
| ä¾èµ–åŒ…å¤§æ›´æ–° | `./redeploy-clean.sh` | âš¡ |

### âš¡ åŠ é€ŸæŠ€å·§

1. **æ—¥å¸¸å¼€å‘ç”¨ç¼“å­˜æ„å»º**ï¼ˆæ¨èï¼‰
   ```bash
   docker compose up -d --build  # æœ‰ç¼“å­˜ï¼Œå¿«ï¼
   ```

2. **åªæ”¹ä»£ç ä¸æ”¹ä¾èµ–æ—¶æœ€å¿«**
   - Dockerfile ä¼šæ™ºèƒ½æ£€æµ‹
   - åªé‡æ–°æ„å»ºæ”¹åŠ¨çš„éƒ¨åˆ†
   - é€šå¸¸ 10-30 ç§’å®Œæˆ

3. **æ‰‹åŠ¨æ¸…ç†ç¼“å­˜ï¼ˆä»…å¿…è¦æ—¶ï¼‰**
   ```bash
   docker builder prune  # æ¸…ç†æ„å»ºç¼“å­˜
   docker system prune   # æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨èµ„æº
   ```

### ğŸš« é¿å…çš„åšæ³•

```bash
# âŒ ä¸æ¨èï¼šæ—§çš„æ‰‹åŠ¨æ–¹å¼ï¼ˆç¹çï¼‰
docker rm -f epkeeper-chatbot
docker build -t epkeeper-chatbot .
docker run -d -p 51872:3000 --name epkeeper-chatbot epkeeper-chatbot

# âŒ ä¸æ¨èï¼šæ¯æ¬¡éƒ½ç”¨ --no-cacheï¼ˆå¤ªæ…¢ï¼‰
docker compose build --no-cache && docker compose up -d

# âœ… æ¨èï¼šç®€å•ç›´æ¥
docker compose up -d --build
```

---

**è®°ä½è¿™ä¸€æ¡å‘½ä»¤å°±å¤Ÿäº†ï¼š**
```bash
docker compose up -d --build
```

å°±è¿™ä¹ˆç®€å•ï¼ğŸ‰

